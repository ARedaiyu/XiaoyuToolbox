<UserControl
    x:Class="XiaoyuToolbox.Views.Calculator.DateCalculatorView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:sys="clr-namespace:System;assembly=netstandard"
    xmlns:vm="clr-namespace:XiaoyuToolbox.Views.Calculator"
    d:DesignHeight="600"
    d:DesignWidth="800"
    Background="White"
    FontSize="16"
    mc:Ignorable="d">
    <UserControl.DataContext>
        <vm:DateCalculatorViewModel />
    </UserControl.DataContext>

    <UserControl.Resources>
        <Thickness x:Key="MarginA1">10</Thickness>
        <Thickness x:Key="MarginA2">5</Thickness>

        <Thickness x:Key="MarginB1">10,0,0,0</Thickness>
        <Thickness x:Key="MarginB2">5,0,0,0</Thickness>
        <Thickness x:Key="MarginB3">5,0,15,0</Thickness>

        <sys:Double x:Key="StackPanelHeight">26</sys:Double>
        <sys:Double x:Key="TextBoxWidth1">80</sys:Double>

        <Style TargetType="RadioButton">
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="VerticalContentAlignment" Value="Center" />
        </Style>

        <Style TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style TargetType="Button">
            <Setter Property="Width" Value="60" />
        </Style>

        <DataTemplate x:Key="DateTemplate" DataType="vm:DateModel">
            <StackPanel
                Height="{StaticResource StackPanelHeight}"
                Margin="{StaticResource MarginA2}"
                Orientation="Horizontal">
                <TextBox
                    Width="60"
                    MaxLength="4"
                    Text="{Binding Year, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <TextBlock Margin="{StaticResource MarginB3}" Text="年" />

                <TextBox
                    Width="40"
                    MaxLength="2"
                    Text="{Binding Month, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <TextBlock Margin="{StaticResource MarginB3}" Text="月" />

                <TextBox
                    Width="40"
                    MaxLength="2"
                    Text="{Binding Day, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <TextBlock Margin="{StaticResource MarginB3}" Text="日" />

                <Button
                    Command="{Binding TodayCommand}"
                    Content="今天"
                    Visibility="{Binding TodayVisibility}" />
            </StackPanel>
        </DataTemplate>
    </UserControl.Resources>

    <Grid Margin="100,20">
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition />
        </Grid.RowDefinitions>

        <GroupBox Header="日期加减">
            <StackPanel Margin="{StaticResource MarginA1}" HorizontalAlignment="Center">
                <ContentControl
                    HorizontalAlignment="Center"
                    Content="{Binding BaseDate}"
                    ContentTemplate="{StaticResource DateTemplate}" />

                <StackPanel
                    Height="{StaticResource StackPanelHeight}"
                    Margin="{StaticResource MarginA2}"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal">
                    <RadioButton Content="加上" IsChecked="{Binding IsAdd, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                    <RadioButton
                        Margin="{StaticResource MarginB1}"
                        Content="减去"
                        IsChecked="{Binding IsMinus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                    <TextBox
                        Width="{StaticResource TextBoxWidth1}"
                        Margin="{StaticResource MarginB1}"
                        Text="{Binding OffsetDays, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                    <TextBlock Margin="{StaticResource MarginB2}" Text="天" />

                    <Button
                        Margin="{StaticResource MarginB1}"
                        Command="{Binding CalculateNewDateCommand}"
                        Content="计算" />
                </StackPanel>

                <ContentControl
                    HorizontalAlignment="Center"
                    Content="{Binding ResultDate}"
                    ContentTemplate="{StaticResource DateTemplate}" />
            </StackPanel>
        </GroupBox>

        <GroupBox Grid.Row="1" Header="日期差">
            <StackPanel Margin="{StaticResource MarginA1}" HorizontalAlignment="Center">
                <ContentControl
                    HorizontalAlignment="Center"
                    Content="{Binding StartDate}"
                    ContentTemplate="{StaticResource DateTemplate}" />

                <ContentControl
                    HorizontalAlignment="Center"
                    Content="{Binding EndDate}"
                    ContentTemplate="{StaticResource DateTemplate}" />

                <StackPanel
                    Height="{StaticResource StackPanelHeight}"
                    Margin="{StaticResource MarginA2}"
                    HorizontalAlignment="Center"
                    Orientation="Horizontal">
                    <Button Command="{Binding CalculateDiffDaysCommand}" Content="计算" />

                    <TextBlock Margin="{StaticResource MarginB1}" Text="相差" />

                    <TextBox
                        Width="{StaticResource TextBoxWidth1}"
                        Margin="{StaticResource MarginB1}"
                        Text="{Binding DiffDays, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                    <TextBlock Margin="{StaticResource MarginB1}" Text="天" />
                </StackPanel>
            </StackPanel>
        </GroupBox>
    </Grid>
</UserControl>
